<!doctype html><html lang=zh-tw dir=auto><head><meta name=generator content="Hugo 0.121.1"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ZhengWei Liu's blogs</title>
<meta name=keywords content="Blog,Portfolio,PaperMod"><meta name=description content><meta name=author content="ZhengWei, Liu"><link rel=canonical href=https://blog.zhengweiliu.com/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.29e0172bca6bbf5268898a52f3a885c467a617731b5b09d0b1a4dbe03dedcd11.css integrity="sha256-KeAXK8prv1JoiYpS86iFxGemF3MbWwnQsaTb4D3tzRE=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.zhengweiliu.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://blog.zhengweiliu.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://blog.zhengweiliu.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://blog.zhengweiliu.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://blog.zhengweiliu.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.zhengweiliu.com/index.xml><link rel=alternate type=application/json href=https://blog.zhengweiliu.com/index.json><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="ZhengWei Liu's blogs"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://blog.zhengweiliu.com/"><meta property="og:image" content="https://blog.zhengweiliu.com/mountain-cover.png"><meta property="og:site_name" content="ZhengWei Liu's blogs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.zhengweiliu.com/mountain-cover.png"><meta name=twitter:title content="ZhengWei Liu's blogs"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"ZhengWei Liu's blogs","url":"https://blog.zhengweiliu.com/","description":"","thumbnailUrl":"https://blog.zhengweiliu.com/%3Clink%20/%20abs%20url%3E","sameAs":["https://www.linkedin.com/in/zheng-wei-liu-1ab77573/","https://github.com/zhweiliu","https://leetcode.com/zhweiliu/"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.zhengweiliu.com/ accesskey=h title="ğŸ  ZhengWei's Blog (Alt + H)"><img src=https://blog.zhengweiliu.com/apple-touch-icon.png alt aria-label=logo height=35>ğŸ  ZhengWei's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.zhengweiliu.com/search/ title="ğŸ” Search (Alt + /)" accesskey=/><span>ğŸ” Search</span></a></li><li><a href=https://blog.zhengweiliu.com/categories/ title="ğŸ·ï¸ Categories"><span>ğŸ·ï¸ Categories</span></a></li><li><a href=https://blog.zhengweiliu.com/archives/ title="ğŸ“š Archives"><span>ğŸ“š Archives</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 185. Department Top Three Salaries</h2></header><div class=entry-content><p>é¡Œç›® Table: Employee +--------------+---------+ | Column Name | Type | +--------------+---------+ | id | int | | name | varchar | | salary | int | | departmentId | int | +--------------+---------+ id is the primary key column for this table. departmentId is a foreign key of the ID from the Department table. Each row of this table indicates the ID, name, and salary of an employee. It also...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 17:21:44.783 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;677 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 185. Department Top Three Salaries" href=https://blog.zhengweiliu.com/posts/leetcode/database/department-top-three-salaries/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 262. Trips and Users</h2></header><div class=entry-content><p>é¡Œç›® Table: Trips +-------------+----------+ | Column Name | Type | +-------------+----------+ | id | int | | client_id | int | | driver_id | int | | city_id | int | | status | enum | | request_at | date | +-------------+----------+ id is the primary key for this table. The table holds all taxi trips. Each trip has a unique id, while client_id and driver_id are foreign keys...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 17:08:27.973 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;836 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 262. Trips and Users" href=https://blog.zhengweiliu.com/posts/leetcode/database/trips-and-users/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 569. Median Employee Salary</h2></header><div class=entry-content><p>é¡Œç›® Table: Employee +--------------+---------+ | Column Name | Type | +--------------+---------+ | id | int | | company | varchar | | salary | int | +--------------+---------+ id is the primary key column for this table. Each row of this table indicates the company and the salary of one employee. Write an SQL query to find the rows that contain the median salary of each company. While calculating the...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 16:48:49.861 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;502 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 569. Median Employee Salary" href=https://blog.zhengweiliu.com/posts/leetcode/database/median-employee-salary/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 571. Find Median Given Frequency of Numbers</h2></header><div class=entry-content><p>é¡Œç›® Table: Numbers +-------------+------+ | Column Name | Type | +-------------+------+ | num | int | | frequency | int | +-------------+------+ num is the primary key for this table. Each row of this table shows the frequency of a number in the database. The median is the value separating the higher half from the lower half of a data sample. Write an SQL query to report the median...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 16:31:02.761 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;646 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 571. Find Median Given Frequency of Numbers" href=https://blog.zhengweiliu.com/posts/leetcode/database/find-median-given-frequency-of-numbers/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 579. Find Cumulative Salary of an Employee</h2></header><div class=entry-content><p>é¡Œç›® Table: Employee +-------------+------+ | Column Name | Type | +-------------+------+ | id | int | | month | int | | salary | int | +-------------+------+ (id, month) is the primary key for this table. Each row in the table indicates the salary of an employee in one month during the year 2020. Write an SQL query to calculate the cumulative salary summary for every employee in a...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 15:18:29.163 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;786 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 579. Find Cumulative Salary of an Employee" href=https://blog.zhengweiliu.com/posts/leetcode/database/find-cumulative-salary-of-an-employee/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 601. Human Traffic of Stadium</h2></header><div class=entry-content><p>é¡Œç›® Table: Stadium +---------------+---------+ | Column Name | Type | +---------------+---------+ | id | int | | visit_date | date | | people | int | +---------------+---------+ visit_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit_date, and as the...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 14:55:01.53 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;741 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 601. Human Traffic of Stadium" href=https://blog.zhengweiliu.com/posts/leetcode/database/human-traffic-of-stadium/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 615. Average Salary: Departments VS Company</h2></header><div class=entry-content><p>é¡Œç›® Table: Salary +-------------+------+ | Column Name | Type | +-------------+------+ | id | int | | employee_id | int | | amount | int | | pay_date | date | +-------------+------+ id is the primary key column for this table. Each row of this table indicates the salary of an employee in one month. employee_id is a foreign key from the Employee table. Table: Employee +---------------+------+ | Column...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 14:33:17.216 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;671 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 615. Average Salary: Departments VS Company" href=https://blog.zhengweiliu.com/posts/leetcode/database/average-salary-departments-vs-company/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 618. Students Report By Geography</h2></header><div class=entry-content><p>é¡Œç›® Table: Student +-------------+---------+ | Column Name | Type | +-------------+---------+ | name | varchar | | continent | varchar | +-------------+---------+ There is no primary key for this table. It may contain duplicate rows. Each row of this table indicates the name of a student and the continent they came from. A school has students from Asia, Europe, and America. Write an SQL query to pivot the continent...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 14:08:14.796 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;1 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;449 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 618. Students Report By Geography" href=https://blog.zhengweiliu.com/posts/leetcode/database/students-report-by-geography/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 1097. Game Play Analysis V</h2></header><div class=entry-content><p>é¡Œç›® Table: Activity +--------------+---------+ | Column Name | Type | +--------------+---------+ | player_id | int | | device_id | int | | event_date | date | | games_played | int | +--------------+---------+ (player_id, event_date) is the primary key of this table. This table shows the activity of players of some games. Each row is a record of a player who logged in and played a number of games (possibly...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 13:48:34.28 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;570 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 1097. Game Play Analysis V" href=https://blog.zhengweiliu.com/posts/leetcode/database/game-play-analysis-v/></a></article><article class=post-entry><header class=entry-header><h2>[leetcode][Database][Hard] 1127. User Purchase Platform</h2></header><div class=entry-content><p>é¡Œç›® Table: Spending +-------------+---------+ | Column Name | Type | +-------------+---------+ | user_id | int | | spend_date | date | | platform | enum | | amount | int | +-------------+---------+ The table logs the history of the spending of users that make purchases from an online shopping website that has a desktop and a mobile application. (user_id, spend_date, platform) is the primary key of this table. The...</p></div><footer class=entry-footer>&lt;span title='2022-12-06 13:21:25.529 +0000 UTC'>December 6, 2022&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 åˆ†é˜&amp;nbsp;Â·&amp;nbsp;867 å­—&amp;nbsp;Â·&amp;nbsp;ZhengWei, Liu</footer><a class=entry-link aria-label="post link to [leetcode][Database][Hard] 1127. User Purchase Platform" href=https://blog.zhengweiliu.com/posts/leetcode/database/user-purchase-platform/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://blog.zhengweiliu.com/page/4/>Â«&nbsp;ä¸Šä¸€é &nbsp;
</a><a class=next href=https://blog.zhengweiliu.com/page/6/>ä¸‹ä¸€é &nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://blog.zhengweiliu.com/>ZhengWei Liu's blogs</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>